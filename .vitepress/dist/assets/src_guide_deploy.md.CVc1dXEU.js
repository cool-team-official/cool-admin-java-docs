import{_ as s,a as i,o as a,aj as n}from"./chunks/framework.BjhQB2K5.js";const o=JSON.parse('{"title":"é¡¹ç›®éƒ¨ç½²","description":"","frontmatter":{},"headers":[],"relativePath":"src/guide/deploy.md","filePath":"src/guide/deploy.md","lastUpdated":1721207284000}'),l={name:"src/guide/deploy.md"},h=n(`<h1 id="é¡¹ç›®éƒ¨ç½²" tabindex="-1">é¡¹ç›®éƒ¨ç½² <a class="header-anchor" href="#é¡¹ç›®éƒ¨ç½²" aria-label="Permalink to &quot;é¡¹ç›®éƒ¨ç½²&quot;">â€‹</a></h1><p><a href="https://cool-js.com/service/cloud" target="_blank" rel="noreferrer">ğŸ”¥ ä½ä»·äº‘æœåŠ¡å™¨æ¨è</a></p><div class="tip custom-block"><p class="custom-block-title">æ³¨æ„</p><p>ä»¥ä¸‹æ•™ç¨‹ä»¥ Nodejs ç‰ˆæœ¬ä¸ºä¾‹ï¼ŒJava ç‰ˆæœ¬çš„ä¹Ÿå¯ä»¥å‚è€ƒ</p></div><h2 id="æ™®é€šæ–¹å¼" tabindex="-1">æ™®é€šæ–¹å¼ <a class="header-anchor" href="#æ™®é€šæ–¹å¼" aria-label="Permalink to &quot;æ™®é€šæ–¹å¼&quot;">â€‹</a></h2><p>æœ¬éƒ¨ç½²æ•™ç¨‹ä»¥ node ç‰ˆæœ¬+å®å¡”ä¸ºä¾‹ï¼Œå…¶ä»–éƒ¨ç½²æ–¹å¼ä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ªæµç¨‹ã€‚</p><p><a href="https://www.bilibili.com/video/BV1m1421S7tm/" target="_blank" rel="noreferrer">cool-admin éƒ¨ç½²è§†é¢‘æ•™ç¨‹</a></p><h4 id="_1ã€éƒ¨ç½²æµç¨‹-ä»¥å®å¡”ä¸ºä¾‹" tabindex="-1">1ã€éƒ¨ç½²æµç¨‹(ä»¥å®å¡”ä¸ºä¾‹)ï¼š <a class="header-anchor" href="#_1ã€éƒ¨ç½²æµç¨‹-ä»¥å®å¡”ä¸ºä¾‹" aria-label="Permalink to &quot;1ã€éƒ¨ç½²æµç¨‹(ä»¥å®å¡”ä¸ºä¾‹)ï¼š&quot;">â€‹</a></h4><ol><li>æ‹‰å–å‰åç«¯ä»£ç ï¼›</li><li>æœ¬åœ°é…ç½®å®Œæ•°æ®åº“è¿è¡Œï¼Œç­‰å¾…æ•°æ®åº“åˆå§‹åŒ–å®Œæˆï¼›</li><li>æ‰“åŒ…å‰åç«¯ä»£ç ï¼Œæ‰“åŒ…ä¹‹å‰æ³¨æ„é…ç½®ç”Ÿäº§ç¯å¢ƒçš„æ•°æ®åº“é…ç½®<code>config/config.prod.ts</code>ï¼Œ<a href="http://www.midwayjs.org/docs/env_config" target="_blank" rel="noreferrer">æŸ¥çœ‹ midway å®˜æ–¹å¤šç¯å¢ƒé…ç½®æ–‡æ¡£</a>ï¼›</li><li>æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡ï¼Œå®‰è£…å®å¡”ã€mysqlã€nodejsã€nginxã€pnpm ç­‰ï¼›</li><li>ä¸Šä¼ å‰åç«¯ä»£ç åˆ°æœåŠ¡å™¨ï¼›</li><li>å®‰è£…ä¾èµ–ï¼Œç¼–è¯‘æ‰“åŒ…åç«¯æœåŠ¡ï¼Œå¯åŠ¨æœåŠ¡ï¼›</li><li>é…ç½® nginx åå‘ä»£ç†ï¼›</li><li>è®¿é—®åŸŸåï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ­å–œä½ ï¼Œéƒ¨ç½²æˆåŠŸï¼</li></ol><div class="warning custom-block"><p class="custom-block-title">æ³¨æ„</p><ul><li>çº¿ä¸Šçš„æ•°æ®åº“æ˜¯éœ€è¦æœ¬åœ°ä¼ ä¸Šå»çš„ï¼Œå®‰å…¨è€ƒè™‘ç”Ÿäº§ç¯å¢ƒä¸ä¼šè‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“ï¼›</li><li>å‰ç«¯è®¿é—®åç«¯çš„æ¥å£åœ°å€é»˜è®¤æ˜¯å‰ç«¯æ ¹åœ°å€+/apiï¼Œæ‰€ä»¥éœ€è¦é…ç½® nginx åå‘ä»£ç†/api åˆ°åç«¯æœåŠ¡ï¼›</li></ul></div><h4 id="_2ã€æ¨èä½¿ç”¨-pnpm-å®‰è£…ä¾èµ–" tabindex="-1">2ã€æ¨èä½¿ç”¨ pnpm å®‰è£…ä¾èµ– <a class="header-anchor" href="#_2ã€æ¨èä½¿ç”¨-pnpm-å®‰è£…ä¾èµ–" aria-label="Permalink to &quot;2ã€æ¨èä½¿ç”¨ pnpm å®‰è£…ä¾èµ–&quot;">â€‹</a></h4><p><a href="https://pnpm.io/" target="_blank" rel="noreferrer">pnpm å®˜ç½‘</a></p><p>å®‰è£…</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pnpm</span></span></code></pre></div><p>é…ç½®æ·˜å®é•œåƒ</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://registry.npmmirror.com</span></span></code></pre></div><h4 id="_3ã€pm2-è¿è¡Œåç«¯æœåŠ¡" tabindex="-1">3ã€PM2 è¿è¡Œåç«¯æœåŠ¡ <a class="header-anchor" href="#_3ã€pm2-è¿è¡Œåç«¯æœåŠ¡" aria-label="Permalink to &quot;3ã€PM2 è¿è¡Œåç«¯æœåŠ¡&quot;">â€‹</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> å‘½ä»¤è¡Œå®‰è£…</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pm2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pm2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span></span></code></pre></div><p>å¸¸ç”¨å‘½ä»¤</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> å¯åŠ¨ä¸€ä¸ªæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> åˆ—å‡ºå½“å‰çš„æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> åœæ­¢æŸä¸ªæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> é‡å¯æŸä¸ªæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> åˆ é™¤æŸä¸ªæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> æŸ¥çœ‹æœåŠ¡çš„è¾“å‡ºæ—¥å¿—</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span></span></code></pre></div><p>cluster æ–¹å¼å¯åŠ¨</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> è¡¨ç¤º</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> number-instances</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> å®ä¾‹æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> è¡¨ç¤º</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM2å°†è‡ªåŠ¨æ£€æµ‹å¯ç”¨CPUçš„æ•°é‡</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> å¯ä»¥è‡ªå·±æŒ‡å®šæ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./bootstrap.js</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> max</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool-admin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">æ”¹æˆè‡ªå·±çš„åº”ç”¨åç§°</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> é‡å¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool-admin</span></span></code></pre></div><p>æ—¥å¿—</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool-admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> é»˜è®¤çš„æ—¥å¿—ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/root/.pm2/logs</span></span></code></pre></div><h4 id="_4ã€nginx-é…ç½®ç¤ºä¾‹" tabindex="-1">4ã€nginx é…ç½®ç¤ºä¾‹ <a class="header-anchor" href="#_4ã€nginx-é…ç½®ç¤ºä¾‹" aria-label="Permalink to &quot;4ã€nginx é…ç½®ç¤ºä¾‹&quot;">â€‹</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">upstream cool {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        server </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">127.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">server</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    # å‰ç«¯æ‰“åŒ…å®Œæ”¾è¿™è¾¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">front;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    # é˜²æ­¢åˆ·æ–°404</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    location </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    try_files $uri $uri</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    # ä»£ç†æœåŠ¡ç«¯åœ°å€  è®¿é—®</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api è¡¨ç¤ºè®¿é—®æœåŠ¡ç«¯æ¥å£è€Œä¸æ˜¯é™æ€èµ„æº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    location </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_pass </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//cool/;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header Host $host;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Real</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $remote_addr;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Forwarded</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">For $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">REMOTE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HOST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $remote_addr;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_cache_bypass no_cache;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #ç¼“å­˜ç›¸å…³é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #proxy_cache cache_one;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #proxy_cache_key $host$request_uri$is_args$args;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #proxy_cache_valid </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 304</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 301</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 302</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1h;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #æŒä¹…åŒ–è¿æ¥ç›¸å…³é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_connect_timeout 3000s;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_read_timeout 86400s;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_send_timeout 3000s;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #proxy_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #proxy_set_header Upgrade $http_upgrade;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #proxy_set_header Connection </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;upgrade&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        add_header </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Cache $upstream_cache_status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #expires 12h;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    # socketéœ€é¢å¤–é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    location </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">socket {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_pass </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//cool/socket;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_connect_timeout 3600s; #é…ç½®ç‚¹1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_read_timeout 3600s; #é…ç½®ç‚¹2,å¦‚æœæ²¡æ•ˆ,å¯ä»¥è€ƒè™‘è¿™ä¸ªæ—¶é—´é…ç½®é•¿ä¸€ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_send_timeout 3600s; #é…ç½®ç‚¹3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header Host $host;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Real</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $remote_addr;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Forwarded</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">For $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">REMOTE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HOST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $remote_addr;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        #proxy_bind $remote_addr transparent;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header Upgrade $http_upgrade;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_set_header Connection </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;upgrade&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        rewrite </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">socket</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy_redirect off;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="docker-æ–¹å¼" tabindex="-1">Docker æ–¹å¼ <a class="header-anchor" href="#docker-æ–¹å¼" aria-label="Permalink to &quot;Docker æ–¹å¼&quot;">â€‹</a></h2><p>docker éƒ¨ç½²çš„é…ç½®æ–¹å¼å¯ä»¥å‚è€ƒæ™®é€šçš„éƒ¨ç½²æ–¹å¼ï¼Œä»¥ä¸‹æ˜¯ docker éƒ¨ç½²çš„ç®€å•æµç¨‹ï¼›</p><p><a href="https://www.bilibili.com/video/BV14z421f7S9/" target="_blank" rel="noreferrer">cool-admin éƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆDocker æ–¹å¼ï¼‰</a></p><h4 id="_1ã€éƒ¨ç½²æµç¨‹-ä»¥å®å¡”ä¸ºä¾‹-1" tabindex="-1">1ã€éƒ¨ç½²æµç¨‹(ä»¥å®å¡”ä¸ºä¾‹)ï¼š <a class="header-anchor" href="#_1ã€éƒ¨ç½²æµç¨‹-ä»¥å®å¡”ä¸ºä¾‹-1" aria-label="Permalink to &quot;1ã€éƒ¨ç½²æµç¨‹(ä»¥å®å¡”ä¸ºä¾‹)ï¼š&quot;">â€‹</a></h4><ol><li>æ‹‰å–å‰åç«¯ä»£ç ï¼›</li><li>æœ¬åœ°é…ç½®å®Œæ•°æ®åº“è¿è¡Œï¼Œç­‰å¾…æ•°æ®åº“åˆå§‹åŒ–å®Œæˆï¼›</li><li>æ‰“åŒ…åç«¯å’Œå‰ç«¯é•œåƒï¼›</li><li>åˆ›å»º docker networkï¼›</li><li>docker è¿è¡Œåç«¯å’Œå‰ç«¯ï¼›</li><li>è®¿é—®å¦‚æœç™»å½•é¡µæ­£å¸¸å‡ºç°éªŒè¯ç ï¼Œæ­å–œä½ ï¼Œéƒ¨ç½²æˆåŠŸï¼</li></ol><h4 id="_2ã€æ‰“åŒ…é•œåƒ" tabindex="-1">2ã€æ‰“åŒ…é•œåƒ <a class="header-anchor" href="#_2ã€æ‰“åŒ…é•œåƒ" aria-label="Permalink to &quot;2ã€æ‰“åŒ…é•œåƒ&quot;">â€‹</a></h4><div class="warning custom-block"><p class="custom-block-title">æ³¨æ„</p><p>æ‰“åŒ…é•œåƒä¹‹å‰ï¼Œéœ€è¦ç¡®ä¿å‰ç«¯å’Œåç«¯åœ¨æœ¬åœ°è¿è¡Œè¿‡ä¸€æ¬¡ï¼Œè®©å‰ç«¯èƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆ<code>eps.json</code>æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯å‰ç«¯è‡ªåŠ¨æ‰«æåç«¯æ¥å£ç”Ÿæˆçš„ï¼Œæœ‰äº†è¯¥æ–‡ä»¶ï¼Œå‰ç«¯ä¸éœ€è¦ç‰¹æ„å†™è°ƒç”¨æ¥å£çš„ serviceã€‚</p><p>å¦‚æœä½ æ˜¯è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œä½ éœ€è¦æŠŠç”Ÿæˆçš„<code>eps.json</code>ä¹Ÿæäº¤åˆ°ä»£ç ä»“åº“ï¼Œå¦åˆ™ä½ å°†æ— æ³•æ­£å¸¸è®¿é—®ä½ çš„ api æ¥å£ã€‚</p></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> åˆ›å»ºdocker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> æ‰“åŒ…åç«¯é•œåƒ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool-admin-midway:1.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> æ‰“åŒ…å‰ç«¯é•œåƒ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool-admin-vue:1.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre></div><h4 id="_3ã€è¿è¡Œ" tabindex="-1">3ã€è¿è¡Œ <a class="header-anchor" href="#_3ã€è¿è¡Œ" aria-label="Permalink to &quot;3ã€è¿è¡Œ&quot;">â€‹</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> è¿è¡Œåç«¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8001:8001</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> midway</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool-admin-midway:1.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> è¿è¡Œåç«¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 80:80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vue</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cool-admin-vue:1.0</span></span></code></pre></div><h4 id="æ³¨æ„äº‹é¡¹" tabindex="-1">æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h4><p>docker éƒ¨ç½²ï¼Œå»ºè®®å°†ç¼“å­˜æ¢æˆ redisï¼Œæ–‡ä»¶ä¸Šä¼ æ¢æˆäº‘å­˜å‚¨ï¼Œå¦‚ï¼šossï¼Œé˜²æ­¢æ“ä½œä¸å½“å¯¼è‡´çš„æ•°æ®ä¸¢å¤±ã€‚</p>`,37),p=[h];function t(k,e,r,d,E,F){return a(),i("div",null,p)}const c=s(l,[["render",t]]);export{o as __pageData,c as default};
